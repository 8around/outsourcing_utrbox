# 035. ì´ë©”ì¼ ì¸ì¦ ì»¤ìŠ¤í„°ë§ˆì´ì§• ë° ì‚¬ìš©ì í”¼ë“œë°± ê°œì„  (ìˆ˜ì •ë³¸)

## ğŸ“‹ ê°œìš”

Supabase ê¸°ë³¸ ì´ë©”ì¼ ì¸ì¦ í…œí”Œë¦¿ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬, í”„ë¡œì íŠ¸ ì„œë²„ì—ì„œ TokenHashë¥¼ ë°›ì•„ `verifyOtp` í•¨ìˆ˜ë¡œ í† í°ì„ ê²€ì¦í•˜ê³ , **ì¦‰ì‹œ ì„¸ì…˜ì„ ì œê±°**í•˜ì—¬ ì´ë©”ì¼ ì¸ì¦ë§Œ ì™„ë£Œí•©ë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ë©´ì„œ toastë¡œ ì¸ì¦ ê²°ê³¼ì™€ ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœë¥¼ ëª…í™•íˆ ì „ë‹¬í•©ë‹ˆë‹¤.

## ğŸ¯ ëª©í‘œ

1. ì´ë©”ì¼ ì¸ì¦ ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ë¥¼ ì‚¬ìš©ìì—ê²Œ ëª…í™•í•˜ê²Œ ì „ë‹¬
2. ì„œë²„ì‚¬ì´ë“œì—ì„œ í† í° ê²€ì¦ ì²˜ë¦¬ (ì„¸ì…˜ì€ ì¦‰ì‹œ ì œê±°)
3. ì‚¬ìš©ì ê²½í—˜ ê°œì„  (toast ì•Œë¦¼ + ì¬ì „ì†¡ ë²„íŠ¼ ì œê³µ)
4. **ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœ ëª…í™•íˆ ì•ˆë‚´**
5. **AuthError ì½”ë“œë³„ ì„¸ë°€í•œ ì—ëŸ¬ ì²˜ë¦¬**

## ğŸ” í˜„ì¬ ë¬¸ì œ ìƒí™©

### ê¸°ì¡´ ì´ë©”ì¼ ì¸ì¦ Flow
```
1. ì‚¬ìš©ì íšŒì›ê°€ì… (signUpUser)
   â†“
2. Supabase Authì— ì‚¬ìš©ì ìƒì„± (metadata: name, organization)
   â†“
3. Supabaseê°€ ê¸°ë³¸ ì´ë©”ì¼ í…œí”Œë¦¿ìœ¼ë¡œ ì¸ì¦ ë©”ì¼ ë°œì†¡
   - URL: https://project-ref.supabase.co/auth/v1/verify?token={{ .TokenHash }}&type=email&redirect_to=...
   â†“
4. ì‚¬ìš©ìê°€ ì´ë©”ì¼ ë§í¬ í´ë¦­
   â†“
5. Supabaseê°€ ìì²´ì ìœ¼ë¡œ í† í° ê²€ì¦ ì²˜ë¦¬
   â†“
6. redirect_to URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë§Œ ìˆ˜í–‰
   â†“
7. auth.users.email_confirmed_at ì—…ë°ì´íŠ¸
   â†“
8. handle_new_user íŠ¸ë¦¬ê±°ê°€ ê°ì§€í•˜ì—¬ public.users ìƒì„±
```

### ë¬¸ì œì 
- âŒ Supabaseê°€ ìì²´ ì²˜ë¦¬ í›„ redirectë§Œ í•˜ë¯€ë¡œ **ì‚¬ìš©ìê°€ ì¸ì¦ ì„±ê³µ/ì‹¤íŒ¨ë¥¼ ì œëŒ€ë¡œ ì•Œ ìˆ˜ ì—†ìŒ**
- âŒ ì„œë²„ì‚¬ì´ë“œì—ì„œ ì¸ì¦ í”„ë¡œì„¸ìŠ¤ ì œì–´ ë¶ˆê°€
- âŒ ì¸ì¦ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ í”¼ë“œë°± ì—†ìŒ
- âŒ **verifyOtp ì„±ê³µ ì‹œ ìë™ ë¡œê·¸ì¸ë˜ì–´ ê´€ë¦¬ì ìŠ¹ì¸ ì—†ì´ ì„¸ì…˜ì´ ìƒì„±ë¨**

## ğŸ“š verifyOtp í•¨ìˆ˜ ë¶„ì„ (Research ê²°ê³¼)

### í•µì‹¬ ë°œê²¬ ì‚¬í•­

#### âœ… verifyOtpëŠ” ì´ë©”ì¼ ì¸ì¦ê³¼ ë¡œê·¸ì¸ì„ **ë™ì‹œì—** ìˆ˜í–‰

**ê³µì‹ ë¬¸ì„œ í™•ì¸ ê²°ê³¼**:
```javascript
const { data: { session }, error } = await supabase.auth.verifyOtp({
  email: 'email@example.com',
  token: '123456',
  type: 'email',
})
```

> "If successful, the user is now **logged in**, and you receive a **valid session**"

**ì„¸ì…˜ ìƒì„± ë©”ì»¤ë‹ˆì¦˜**:
- `verifyOtp` ë©”ì„œë“œëŠ” **POST ìš”ì²­**ìœ¼ë¡œ Supabase Authì— ê²€ì¦ ìš”ì²­
- ì„±ê³µ ì‹œ **session ê°ì²´ê°€ response bodyì— ë°˜í™˜ë¨**
- ì„œë²„ì‚¬ì´ë“œì—ì„œ ì„¸ì…˜ì„ ì½ì„ ìˆ˜ ìˆìŒ (ê¸°ë³¸ flowëŠ” URL fragmentì— í¬í•¨ë˜ì–´ ì„œë²„ì—ì„œ ì ‘ê·¼ ë¶ˆê°€)
- **âš ï¸ í•˜ì§€ë§Œ ê´€ë¦¬ì ìŠ¹ì¸ì´ í•„ìš”í•˜ë¯€ë¡œ ì„¸ì…˜ì„ ì¦‰ì‹œ ì œê±°í•´ì•¼ í•¨**

#### ğŸš¨ AuthError íƒ€ì… í™•ì¸

**ê³µì‹ ë¬¸ì„œ í™•ì¸**:
- `verifyOtp`ëŠ” ì‹¤íŒ¨ ì‹œ `AuthApiError` íƒ€ì… ë°˜í™˜
- `AuthApiError`ëŠ” `code` ì†ì„±ìœ¼ë¡œ ì—ëŸ¬ ì‹ë³„ ê°€ëŠ¥
- HTTP status codeë„ í•¨ê»˜ ë°˜í™˜ë¨

**ì£¼ìš” ì†ì„±**:
```typescript
interface AuthApiError {
  name: string
  message: string
  code: string          // ì—ëŸ¬ ì½”ë“œ (ì˜ˆ: 'otp_expired')
  status: number        // HTTP status code
}
```

### AuthError ì½”ë“œ ëª©ë¡ (verifyOtp ê´€ë ¨)

#### ğŸ“§ ì´ë©”ì¼ ì¸ì¦ ê´€ë ¨ ì—ëŸ¬

| ì—ëŸ¬ ì½”ë“œ | ì„¤ëª… | HTTP Status |
|----------|------|-------------|
| `otp_expired` | OTP ì½”ë“œê°€ ë§Œë£Œë¨ (ê¸°ë³¸ 1ì‹œê°„) | 403 |
| `otp_disabled` | OTP ì¸ì¦ì´ ë¹„í™œì„±í™”ë¨ | 403 |
| `invalid_credentials` | ì˜ëª»ëœ í† í° ë˜ëŠ” ì¸ì¦ ì •ë³´ | 401 |
| `user_not_found` | ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ | 404 |
| `email_not_confirmed` | ì´ë©”ì¼ì´ ì¸ì¦ë˜ì§€ ì•ŠìŒ | 403 |

#### â±ï¸ Rate Limit ê´€ë ¨ ì—ëŸ¬

| ì—ëŸ¬ ì½”ë“œ | ì„¤ëª… | HTTP Status |
|----------|------|-------------|
| `over_email_send_rate_limit` | ì´ë©”ì¼ ì „ì†¡ ì œí•œ ì´ˆê³¼ | 429 |
| `over_request_rate_limit` | ìš”ì²­ íšŸìˆ˜ ì œí•œ ì´ˆê³¼ (IP ê¸°ë°˜) | 429 |

#### ğŸ”§ ì‹œìŠ¤í…œ/ê²€ì¦ ì—ëŸ¬

| ì—ëŸ¬ ì½”ë“œ | ì„¤ëª… | HTTP Status |
|----------|------|-------------|
| `validation_failed` | íŒŒë¼ë¯¸í„° í˜•ì‹ ì˜¤ë¥˜ | 422 |
| `unexpected_failure` | ì˜ˆìƒì¹˜ ëª»í•œ ì„œë²„ ì˜¤ë¥˜ | 500 |
| `bad_code_verifier` | PKCE code verifier ë¶ˆì¼ì¹˜ | 401 |
| `flow_state_expired` | PKCE flow state ë§Œë£Œ | 410 |
| `flow_state_not_found` | PKCE flow state ì—†ìŒ | 404 |

## ğŸ¨ í•´ê²° ë°©ì•ˆ

### ìƒˆë¡œìš´ ì´ë©”ì¼ ì¸ì¦ Flow
```
1. ì‚¬ìš©ì íšŒì›ê°€ì… (signUpUser)
   â†“
2. Supabase Authì— ì‚¬ìš©ì ìƒì„±
   â†“
3. ì»¤ìŠ¤í„°ë§ˆì´ì§•ëœ ì´ë©”ì¼ í…œí”Œë¦¿ìœ¼ë¡œ ì¸ì¦ ë©”ì¼ ë°œì†¡
   - URL: https://yourdomain.com/api/auth/verify?token_hash={{ .TokenHash }}&type=email
   â†“
4. ì‚¬ìš©ìê°€ ì´ë©”ì¼ ë§í¬ í´ë¦­
   â†“
5. âœ… í”„ë¡œì íŠ¸ ì„œë²„ ì—”ë“œí¬ì¸íŠ¸ (/api/auth/verify)ì—ì„œ ìš”ì²­ ì²˜ë¦¬
   â†“
6. âœ… createServerSupabase()ë¡œ í´ë¼ì´ì–¸íŠ¸ ìƒì„±
   â†“
7. âœ… verifyOtpë¡œ í† í° ê²€ì¦ (ì„¸ì…˜ ìƒì„±ë¨)
   â†“
8. âœ… ì¦‰ì‹œ signOut() í˜¸ì¶œí•˜ì—¬ ì„¸ì…˜ ì œê±°
   â†“
9. âœ… ì„±ê³µ/ì‹¤íŒ¨ì— ë”°ë¼ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ + ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¶”ê°€
   - ì„±ê³µ: /login?verified=success&message=...
   - ì‹¤íŒ¨: /login?verified=error&code=otp_expired&message=...
   â†“
10. âœ… ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì½ì–´ toast í‘œì‹œ + ì¬ì „ì†¡ ë²„íŠ¼
   â†“
11. auth.users.email_confirmed_at ì—…ë°ì´íŠ¸
   â†“
12. handle_new_user íŠ¸ë¦¬ê±°ê°€ ê°ì§€í•˜ì—¬ public.users ìƒì„±
```

### ê°œì„  íš¨ê³¼
- âœ… ì‚¬ìš©ìì—ê²Œ ì¸ì¦ ì„±ê³µ/ì‹¤íŒ¨ ëª…í™•í•œ í”¼ë“œë°± ì œê³µ
- âœ… ì„œë²„ì‚¬ì´ë“œì—ì„œ ì¸ì¦ í”„ë¡œì„¸ìŠ¤ ì œì–´ ê°€ëŠ¥
- âœ… **ì„¸ì…˜ì„ ì¦‰ì‹œ ì œê±°í•˜ì—¬ ê´€ë¦¬ì ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ìœ ì§€**
- âœ… AuthError ì½”ë“œë³„ ì„¸ë°€í•œ ì—ëŸ¬ ì²˜ë¦¬
- âœ… ëª¨ë“  ì—ëŸ¬ ì¼€ì´ìŠ¤ì—ì„œ ì¬ì „ì†¡ ë²„íŠ¼ ì œê³µ
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹… ì¶”ê°€ ê°€ëŠ¥
- âœ… í–¥í›„ ì¶”ê°€ ë¡œì§ í™•ì¥ ê°€ëŠ¥ (ì˜ˆ: ë¶„ì„, ì•Œë¦¼)

## ğŸ› ï¸ êµ¬í˜„ ê³„íš

### 1ë‹¨ê³„: ì´ë©”ì¼ í…œí”Œë¦¿ ìˆ˜ì • (Supabase Dashboard)

**ìœ„ì¹˜**: Supabase Dashboard â†’ Authentication â†’ Email Templates â†’ Confirm signup

**ìˆ˜ì • ì „** (ê¸°ë³¸ í…œí”Œë¦¿):
```html
<h2>Confirm your signup</h2>
<p>Follow this link to confirm your user:</p>
<p><a href="{{ .ConfirmationURL }}">Confirm your email</a></p>
```

**ìˆ˜ì • í›„** (ì»¤ìŠ¤í…€ í…œí”Œë¦¿):
```html
<h2>ì´ë©”ì¼ ì¸ì¦</h2>

<p>ì•ˆë…•í•˜ì„¸ìš”,</p>
<p>{{ .Email }} ê³„ì •ì˜ ì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí•˜ë ¤ë©´ ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”.</p>

<p style="margin: 30px 0;">
  <a
    href="{{ .SiteURL }}/api/auth/verify?token_hash={{ .TokenHash }}&type=email"
    style="background-color: #4F46E5; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;"
  >
    ì´ë©”ì¼ ì¸ì¦í•˜ê¸°
  </a>
</p>

<p style="color: #6B7280; font-size: 14px;">
  ì´ ë§í¬ëŠ” 24ì‹œê°„ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤.<br>
  ë³¸ì¸ì´ ìš”ì²­í•˜ì§€ ì•Šì€ ê²½ìš° ì´ ë©”ì¼ì„ ë¬´ì‹œí•˜ì…”ë„ ë©ë‹ˆë‹¤.
</p>
```

**ì£¼ìš” ë³€ê²½ ì‚¬í•­**:
- `{{ .ConfirmationURL }}` â†’ ì»¤ìŠ¤í…€ ì—”ë“œí¬ì¸íŠ¸ URLë¡œ ë³€ê²½
- `{{ .TokenHash }}` ì‚¬ìš©í•˜ì—¬ í† í° ì „ë‹¬
- `type=email` íŒŒë¼ë¯¸í„° ì¶”ê°€

### 2ë‹¨ê³„: ì„œë²„ì‚¬ì´ë“œ ê²€ì¦ ì—”ë“œí¬ì¸íŠ¸ ìƒì„±

**íŒŒì¼**: `app/api/auth/verify/route.ts` (ì‹ ê·œ)

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { createServerSupabase } from '@/lib/supabase/server'

// EmailOtpType íƒ€ì… ì •ì˜
type EmailOtpType = 'email' | 'recovery' | 'invite' | 'email_change'

// AuthError ì½”ë“œë³„ ë©”ì‹œì§€ ë§¤í•‘
function getErrorMessage(code: string): string {
  const errorMap: Record<string, string> = {
    // ì´ë©”ì¼ ì¸ì¦ ê´€ë ¨
    otp_expired: 'ì¸ì¦ ë§í¬ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.',
    otp_disabled: 'OTP ì¸ì¦ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.',
    invalid_credentials: 'ì˜ëª»ëœ ì¸ì¦ ë§í¬ì…ë‹ˆë‹¤.',
    user_not_found: 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
    email_not_confirmed: 'ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.',

    // Rate Limit ê´€ë ¨
    over_email_send_rate_limit:
      'ì´ë©”ì¼ ì „ì†¡ ì œí•œ. ê³ ê°ì„¼í„°(support@example.com)ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.',
    over_request_rate_limit: 'ìš”ì²­ íšŸìˆ˜ ì œí•œ ì´ˆê³¼. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',

    // ì‹œìŠ¤í…œ/ê²€ì¦ ì—ëŸ¬
    validation_failed: 'ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤.',
    unexpected_failure: 'ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
    bad_code_verifier: 'ì¸ì¦ ì½”ë“œ ê²€ì¦ ì˜¤ë¥˜ì…ë‹ˆë‹¤.',
    flow_state_expired: 'ì¸ì¦ ìš”ì²­ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.',
    flow_state_not_found: 'ì¸ì¦ ìš”ì²­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
  }

  // ë§¤í•‘ëœ ë©”ì‹œì§€ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ ì½”ë“œ í¬í•¨ ë©”ì‹œì§€ ë°˜í™˜
  return errorMap[code] || `ì¸ì¦ì„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”. (ì½”ë“œ: ${code})`
}

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url)
    const token_hash = searchParams.get('token_hash')
    const type = searchParams.get('type') as EmailOtpType | null

    // íŒŒë¼ë¯¸í„° ê²€ì¦
    if (!token_hash || !type) {
      const errorMessage = 'ì˜ëª»ëœ ì¸ì¦ ë§í¬ì…ë‹ˆë‹¤.'
      return NextResponse.redirect(
        new URL(
          `/login?verified=error&code=validation_failed&message=${encodeURIComponent(errorMessage)}`,
          request.url
        )
      )
    }

    // Supabase í´ë¼ì´ì–¸íŠ¸ ìƒì„±
    const supabase = createServerSupabase()

    // verifyOtpë¡œ í† í° ê²€ì¦ (ì„¸ì…˜ì´ ìë™ ìƒì„±ë¨)
    const {
      data: { session },
      error,
    } = await supabase.auth.verifyOtp({
      token_hash,
      type,
    })

    if (error) {
      console.error('Email verification error:', error)

      const errorCode = error.code || 'unknown'
      const errorMessage = getErrorMessage(errorCode)

      // ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ì½”ë“œì™€ ë©”ì‹œì§€ì™€ í•¨ê»˜ ë¦¬ë‹¤ì´ë ‰íŠ¸
      return NextResponse.redirect(
        new URL(
          `/login?verified=error&code=${errorCode}&message=${encodeURIComponent(errorMessage)}`,
          request.url
        )
      )
    }

    // ì„±ê³µ ì‹œ: ì„¸ì…˜ì´ ìƒì„±ë˜ì—ˆìœ¼ë¯€ë¡œ ì¦‰ì‹œ ì œê±°
    // (ê´€ë¦¬ì ìŠ¹ì¸ì´ í•„ìš”í•˜ë¯€ë¡œ ì´ë©”ì¼ ì¸ì¦ë§Œ ì™„ë£Œ)
    if (session) {
      await supabase.auth.signOut()
      console.log('Email verified successfully, session removed for admin approval')
    }

    // ì„±ê³µ ë©”ì‹œì§€ì™€ í•¨ê»˜ ë¦¬ë‹¤ì´ë ‰íŠ¸
    const successMessage = 'ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.'
    return NextResponse.redirect(
      new URL(
        `/login?verified=success&message=${encodeURIComponent(successMessage)}`,
        request.url
      )
    )
  } catch (error) {
    console.error('Email verification unexpected error:', error)

    const errorMessage =
      error instanceof Error
        ? `ì¸ì¦ì„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”. (ì½”ë“œ: ${error.message})`
        : 'ì¸ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'

    return NextResponse.redirect(
      new URL(
        `/login?verified=error&code=unexpected_failure&message=${encodeURIComponent(errorMessage)}`,
        request.url
      )
    )
  }
}
```

**í•µì‹¬ ë¡œì§**:
1. `token_hash`, `type` ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¶”ì¶œ
2. íŒŒë¼ë¯¸í„° ê²€ì¦
3. `createServerSupabase()`ë¡œ Supabase í´ë¼ì´ì–¸íŠ¸ ìƒì„±
4. `verifyOtp` í˜¸ì¶œí•˜ì—¬ í† í° ê²€ì¦ (ì„¸ì…˜ ìë™ ìƒì„±)
5. **ì„±ê³µ ì‹œ ì¦‰ì‹œ `signOut()` í˜¸ì¶œí•˜ì—¬ ì„¸ì…˜ ì œê±°**
6. ì„±ê³µ/ì‹¤íŒ¨ì— ë”°ë¼ `/login`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (ë©”ì‹œì§€ + ì—ëŸ¬ ì½”ë“œ í¬í•¨)
7. ì—ëŸ¬ ë¡œê¹…

### 3ë‹¨ê³„: ë¡œê·¸ì¸ í˜ì´ì§€ Toast ì•Œë¦¼ + ì¬ì „ì†¡ ë²„íŠ¼ ì¶”ê°€

**íŒŒì¼**: `app/(auth)/login/page.tsx` (ìˆ˜ì •)

**ì¶”ê°€í•  ë¡œì§**:
```typescript
'use client'

import { useEffect, useState } from 'react'
import { useSearchParams, useRouter } from 'next/navigation'
import { toast } from 'sonner'
import { Button } from '@/components/ui/button'

export default function LoginPage() {
  const searchParams = useSearchParams()
  const router = useRouter()
  const [showResendButton, setShowResendButton] = useState(false)
  const [errorCode, setErrorCode] = useState<string | null>(null)

  // ì´ë©”ì¼ ì¸ì¦ ê²°ê³¼ toast í‘œì‹œ
  useEffect(() => {
    const verified = searchParams.get('verified')
    const message = searchParams.get('message')
    const code = searchParams.get('code')

    if (verified === 'success') {
      // ì„±ê³µ ì‹œ í•­ìƒ ë™ì¼í•œ ë©”ì‹œì§€
      toast.success(
        message || 'ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.'
      )

      // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±° (history replace)
      router.replace('/login')
    } else if (verified === 'error') {
      // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
      toast.error(message || 'ì´ë©”ì¼ ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')

      // ì¬ì „ì†¡ ë²„íŠ¼ í‘œì‹œ (ëª¨ë“  ì—ëŸ¬ ì¼€ì´ìŠ¤)
      setShowResendButton(true)
      setErrorCode(code)

      // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±° (history replace)
      router.replace('/login')
    }
  }, [searchParams, router])

  // ì¸ì¦ ë©”ì¼ ì¬ì „ì†¡ í•¸ë“¤ëŸ¬
  const handleResendEmail = async () => {
    try {
      // ì¬ì „ì†¡ API í˜¸ì¶œ êµ¬í˜„ ì˜ˆì •
      toast.info('ì¸ì¦ ë©”ì¼ì„ ì¬ì „ì†¡í–ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.')
      setShowResendButton(false)
    } catch (error) {
      toast.error('ì´ë©”ì¼ ì¬ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
    }
  }

  return (
    <div>
      {/* ê¸°ì¡´ ë¡œê·¸ì¸ í˜ì´ì§€ ì½”ë“œ... */}

      {/* ì¬ì „ì†¡ ë²„íŠ¼ (ì—ëŸ¬ ë°œìƒ ì‹œ í‘œì‹œ) */}
      {showResendButton && (
        <div className="mt-4 text-center">
          <Button
            variant="outline"
            onClick={handleResendEmail}
            className="text-sm"
          >
            ì¸ì¦ ë©”ì¼ ì¬ì „ì†¡
          </Button>
          {errorCode && (
            <p className="mt-2 text-xs text-gray-500">ì—ëŸ¬ ì½”ë“œ: {errorCode}</p>
          )}
        </div>
      )}
    </div>
  )
}
```

**Toast ë©”ì‹œì§€**:
- âœ… ì„±ê³µ: "ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤." (í•­ìƒ ë™ì¼)
- âŒ ì‹¤íŒ¨: AuthError ì½”ë“œë³„ ì„¸ë¶€ ë©”ì‹œì§€ + ì¬ì „ì†¡ ë²„íŠ¼

### 4ë‹¨ê³„: ì¬ì „ì†¡ API ì—”ë“œí¬ì¸íŠ¸ ìƒì„± (í–¥í›„ êµ¬í˜„)

**íŒŒì¼**: `app/api/auth/resend-verification/route.ts` (ì‹ ê·œ, ì„ íƒì‚¬í•­)

ì´ë©”ì¼ ì¬ì „ì†¡ ê¸°ëŠ¥ì€ í–¥í›„ ì¶”ê°€ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { createServerSupabase } from '@/lib/supabase/server'

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    const { email } = body

    // ì´ë©”ì¼ ê²€ì¦
    if (!email) {
      return NextResponse.json(
        { success: false, error: 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.' },
        { status: 400 }
      )
    }

    const supabase = createServerSupabase()

    // Supabaseì˜ resend ê¸°ëŠ¥ ë˜ëŠ” signInWithOtp ì¬í˜¸ì¶œ
    // êµ¬í˜„ ë°©ë²•ì€ í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ê²°ì •

    return NextResponse.json({
      success: true,
      message: 'ì¸ì¦ ë©”ì¼ì´ ì¬ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.',
    })
  } catch (error) {
    console.error('Resend email error:', error)
    return NextResponse.json(
      { success: false, error: 'ì´ë©”ì¼ ì¬ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    )
  }
}
```

## ğŸ“ AuthError ì½”ë“œë³„ ì‚¬ìš©ì ë©”ì‹œì§€ ë§¤í•‘

| ì—ëŸ¬ ì½”ë“œ | ì‚¬ìš©ì ë©”ì‹œì§€ | ì¬ì „ì†¡ ë²„íŠ¼ | ê³ ê°ì„¼í„° ì•ˆë‚´ |
|----------|--------------|-----------|-------------|
| `otp_expired` | ì¸ì¦ ë§í¬ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. | âœ… | âŒ |
| `otp_disabled` | OTP ì¸ì¦ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. | âœ… | âœ… |
| `invalid_credentials` | ì˜ëª»ëœ ì¸ì¦ ë§í¬ì…ë‹ˆë‹¤. | âœ… | âŒ |
| `user_not_found` | ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. | âœ… | âŒ |
| `email_not_confirmed` | ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. | âœ… | âŒ |
| `over_email_send_rate_limit` | ì´ë©”ì¼ ì „ì†¡ ì œí•œ. ê³ ê°ì„¼í„°(support@example.com)ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”. | âœ… | âœ… |
| `over_request_rate_limit` | ìš”ì²­ íšŸìˆ˜ ì œí•œ ì´ˆê³¼. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”. | âœ… | âŒ |
| `validation_failed` | ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. | âœ… | âŒ |
| `unexpected_failure` | ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. | âœ… | âŒ |
| `bad_code_verifier` | ì¸ì¦ ì½”ë“œ ê²€ì¦ ì˜¤ë¥˜ì…ë‹ˆë‹¤. | âœ… | âŒ |
| `flow_state_expired` | ì¸ì¦ ìš”ì²­ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. | âœ… | âŒ |
| `flow_state_not_found` | ì¸ì¦ ìš”ì²­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. | âœ… | âŒ |
| ê¸°íƒ€ unknown | ì¸ì¦ì„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”. (ì½”ë“œ: XXX) | âœ… | âŒ |

## ğŸ“‚ ìˆ˜ì •/ìƒì„± íŒŒì¼ ëª©ë¡

### ì‹ ê·œ ìƒì„±
1. `app/api/auth/verify/route.ts` - ì´ë©”ì¼ ì¸ì¦ ê²€ì¦ ì—”ë“œí¬ì¸íŠ¸ (ì„¸ì…˜ ì œê±° ë¡œì§ í¬í•¨)
2. `app/api/auth/resend-verification/route.ts` - ì¬ì „ì†¡ ì—”ë“œí¬ì¸íŠ¸ (ì„ íƒì‚¬í•­, í–¥í›„ êµ¬í˜„)

### ìˆ˜ì •
1. `app/(auth)/login/page.tsx` - Toast ì•Œë¦¼ + ì¬ì „ì†¡ ë²„íŠ¼ ë¡œì§ ì¶”ê°€
2. Supabase Dashboard - ì´ë©”ì¼ í…œí”Œë¦¿ ìˆ˜ì • (ì½”ë“œë² ì´ìŠ¤ ì™¸ë¶€)

### í™•ì¸ í•„ìš”
1. `next/navigation`ì˜ `useRouter`, `useSearchParams` ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€
2. `sonner` toast ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ì—¬ë¶€
3. `@/components/ui/button` ì»´í¬ë„ŒíŠ¸ ì¡´ì¬ ì—¬ë¶€

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê³„íš

### 1. ì •ìƒ í”Œë¡œìš° í…ŒìŠ¤íŠ¸
```
1. íšŒì›ê°€ì… í˜ì´ì§€ì—ì„œ ì‹ ê·œ ê³„ì • ìƒì„±
2. ì´ë©”ì¼ ìˆ˜ì‹  í™•ì¸
3. ì´ë©”ì¼ ë‚´ "ì´ë©”ì¼ ì¸ì¦í•˜ê¸°" ë²„íŠ¼ í´ë¦­
4. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
5. âœ… ì„±ê³µ toast ë©”ì‹œì§€ í‘œì‹œ í™•ì¸: "ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤."
6. URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±° í™•ì¸
7. âœ… ë¡œê·¸ì¸ ì‹œë„ ì‹œ "ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° ì¤‘" ë©”ì‹œì§€ í™•ì¸ (ì„¸ì…˜ ì—†ìŒ)
8. public.users í…Œì´ë¸”ì— ì‚¬ìš©ì ì •ë³´ ìƒì„± í™•ì¸
9. auth.users.email_confirmed_at ì—…ë°ì´íŠ¸ í™•ì¸
```

### 2. ë§Œë£Œëœ í† í° í…ŒìŠ¤íŠ¸
```
1. íšŒì›ê°€ì… í›„ 1ì‹œê°„ ì´ìƒ ëŒ€ê¸° (ë˜ëŠ” í† í° ë§Œë£Œ ì„¤ì • ì¡°ì •)
2. ë§Œë£Œëœ ì´ë©”ì¼ ë§í¬ í´ë¦­
3. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
4. âŒ ì‹¤íŒ¨ toast ë©”ì‹œì§€ í‘œì‹œ í™•ì¸: "ì¸ì¦ ë§í¬ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
5. âœ… ì¬ì „ì†¡ ë²„íŠ¼ í‘œì‹œ í™•ì¸
6. ì—ëŸ¬ ì½”ë“œ í‘œì‹œ í™•ì¸: "otp_expired"
```

### 3. ì˜ëª»ëœ í† í° í…ŒìŠ¤íŠ¸
```
1. ì´ë©”ì¼ ë§í¬ì˜ token_hash íŒŒë¼ë¯¸í„°ë¥¼ ì„ì˜ë¡œ ìˆ˜ì •
2. ìˆ˜ì •ëœ ë§í¬ í´ë¦­
3. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
4. âŒ ì‹¤íŒ¨ toast ë©”ì‹œì§€ í‘œì‹œ í™•ì¸: "ì˜ëª»ëœ ì¸ì¦ ë§í¬ì…ë‹ˆë‹¤."
5. âœ… ì¬ì „ì†¡ ë²„íŠ¼ í‘œì‹œ í™•ì¸
6. ì—ëŸ¬ ì½”ë“œ í‘œì‹œ í™•ì¸: "invalid_credentials"
```

### 4. íŒŒë¼ë¯¸í„° ëˆ„ë½ í…ŒìŠ¤íŠ¸
```
1. token_hash ë˜ëŠ” type íŒŒë¼ë¯¸í„° ì—†ì´ /api/auth/verify ì ‘ê·¼
2. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
3. âŒ ì—ëŸ¬ toast ë©”ì‹œì§€ í‘œì‹œ í™•ì¸: "ì˜ëª»ëœ ì¸ì¦ ë§í¬ì…ë‹ˆë‹¤."
4. âœ… ì¬ì „ì†¡ ë²„íŠ¼ í‘œì‹œ í™•ì¸
5. ì—ëŸ¬ ì½”ë“œ í‘œì‹œ í™•ì¸: "validation_failed"
```

### 5. Rate Limit í…ŒìŠ¤íŠ¸
```
1. ë™ì¼ ì´ë©”ì¼ë¡œ ì§§ì€ ì‹œê°„ ë‚´ ì—¬ëŸ¬ ë²ˆ ì¸ì¦ ë©”ì¼ ìš”ì²­
2. Rate limit ì—ëŸ¬ ë°œìƒ í™•ì¸
3. âŒ ì—ëŸ¬ toast ë©”ì‹œì§€ í‘œì‹œ í™•ì¸: "ì´ë©”ì¼ ì „ì†¡ ì œí•œ. ê³ ê°ì„¼í„°(support@example.com)ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”."
4. âœ… ì¬ì „ì†¡ ë²„íŠ¼ í‘œì‹œ í™•ì¸
5. ì—ëŸ¬ ì½”ë“œ í‘œì‹œ í™•ì¸: "over_email_send_rate_limit"
```

### 6. ì„¸ì…˜ ì œê±° ê²€ì¦ í…ŒìŠ¤íŠ¸
```
1. ì´ë©”ì¼ ì¸ì¦ ì„±ê³µ ì§í›„
2. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ì—ì„œ ì¿ í‚¤ í™•ì¸
3. âœ… Supabase auth ê´€ë ¨ ì¿ í‚¤ê°€ ì—†ëŠ”ì§€ í™•ì¸
4. API ìš”ì²­ ì‹œ ì¸ì¦ë˜ì§€ ì•Šì€ ìƒíƒœ í™•ì¸
5. ë¡œê·¸ì¸ ì‹œë„í•˜ì—¬ ì •ìƒì ì¸ ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤ ì§„í–‰ í™•ì¸
```

## âš ï¸ ì£¼ì˜ì‚¬í•­ ë° ê³ ë ¤ì‚¬í•­

### í™˜ê²½ ë³€ìˆ˜
- âœ… ì´ë©”ì¼ í…œí”Œë¦¿ì˜ `{{ .SiteURL }}`ì€ Supabase Dashboardì˜ Site URL ì„¤ì •ì„ ì‚¬ìš©
- ë³„ë„ì˜ í™˜ê²½ ë³€ìˆ˜ ë¶ˆí•„ìš”

### Supabase ì„¤ì •
- âœ… Supabase Dashboardì—ì„œ ì´ë©”ì¼ í…œí”Œë¦¿ ìˆ˜ì • í•„ìš” (ì½”ë“œë² ì´ìŠ¤ ì™¸ë¶€)
- âœ… Site URL ì„¤ì • í™•ì¸
  - Supabase Dashboard â†’ Authentication â†’ URL Configuration â†’ Site URL
  - ê°œë°œ: `http://localhost:3000`
  - í”„ë¡œë•ì…˜: `https://yourdomain.com`

### ê¸°ì¡´ ì‹œìŠ¤í…œ ì˜í–¥
- âœ… `handle_new_user` íŠ¸ë¦¬ê±°ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ (email_confirmed_at ê°ì§€ ë¡œì§)
- âœ… ê¸°ì¡´ ë¡œê·¸ì¸ ë¡œì§ (`signInUser`) ë³€ê²½ ë¶ˆí•„ìš”
- âœ… ê¸°ì¡´ íšŒì›ê°€ì… ë¡œì§ (`signUpUser`) ë³€ê²½ ë¶ˆí•„ìš”

### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- âœ… token_hashëŠ” í•œ ë²ˆë§Œ ì‚¬ìš© ê°€ëŠ¥ (Supabase Authê°€ ìë™ ì²˜ë¦¬)
- âœ… í† í° ë§Œë£Œ ì‹œê°„: ê¸°ë³¸ 1ì‹œê°„ (Supabase ì„¤ì •ì—ì„œ ì¡°ì • ê°€ëŠ¥)
- âœ… HTTPS ì‚¬ìš© í•„ìˆ˜ (í”„ë¡œë•ì…˜ í™˜ê²½)
- âœ… **ì„¸ì…˜ ì¦‰ì‹œ ì œê±°ë¡œ ê´€ë¦¬ì ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ìš°íšŒ ë°©ì§€**

### ì—ëŸ¬ ì²˜ë¦¬
- âœ… ëª¨ë“  ì—ëŸ¬ëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ + toast í‘œì‹œ
- âœ… ì„œë²„ ë¡œê·¸ì— ì—ëŸ¬ ìƒì„¸ ê¸°ë¡ (console.error)
- âœ… ì‚¬ìš©ìì—ê²ŒëŠ” ê°„ë‹¨í•˜ê³  ëª…í™•í•œ ë©”ì‹œì§€ë§Œ í‘œì‹œ
- âœ… **ì—ëŸ¬ ì½”ë“œë¥¼ í¬í•¨í•˜ì—¬ ê³ ê°ì„¼í„° ë¬¸ì˜ ì‹œ í™œìš©**

### ê´€ë¦¬ì ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤
- âœ… ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ í›„ ì¦‰ì‹œ ì„¸ì…˜ ì œê±°
- âœ… ì‚¬ìš©ìëŠ” ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœ ëª…í™•íˆ ì¸ì§€
- âœ… ë¡œê·¸ì¸ ì‹œ ìŠ¹ì¸ ì—¬ë¶€ ê²€ì¦ (ê¸°ì¡´ `signInUser` ë¡œì§ í™œìš©)

## ğŸ“Š ì˜ˆìƒ ì˜í–¥ë„

### ê¸ì •ì  ì˜í–¥
- âœ… ì‚¬ìš©ì ê²½í—˜ ëŒ€í­ ê°œì„  (ëª…í™•í•œ í”¼ë“œë°± + ì¬ì „ì†¡ ë²„íŠ¼)
- âœ… ì´ë©”ì¼ ì¸ì¦ í”„ë¡œì„¸ìŠ¤ ì œì–´ ê°•í™”
- âœ… **ê´€ë¦¬ì ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ì •ìƒ ì‘ë™ ë³´ì¥**
- âœ… AuthError ì½”ë“œë³„ ì„¸ë°€í•œ ì—ëŸ¬ ì²˜ë¦¬
- âœ… ì—ëŸ¬ ì¶”ì  ë° ë””ë²„ê¹… ìš©ì´
- âœ… í–¥í›„ í™•ì¥ì„± í™•ë³´ (ì¶”ê°€ ë¡œì§ ì‚½ì… ê°€ëŠ¥)

### ë³€ê²½ ë²”ìœ„
- âœ… **ìµœì†Œ ì¹¨ìŠµì ** ë³€ê²½
- âœ… ê¸°ì¡´ ì¸ì¦ ì‹œìŠ¤í…œê³¼ ë…ë¦½ì 
- âœ… ì‹ ê·œ ì—”ë“œí¬ì¸íŠ¸ 1ê°œ ì¶”ê°€ (ì¬ì „ì†¡ì€ ì„ íƒì‚¬í•­)
- âœ… ë¡œê·¸ì¸ í˜ì´ì§€ useEffect hook + ì¬ì „ì†¡ ë²„íŠ¼ ì¶”ê°€

### ìœ„í—˜ë„
- ğŸŸ¢ **ë‚®ìŒ** - ê¸°ì¡´ ì‹œìŠ¤í…œ ë¡œì§ ë³€ê²½ ì—†ìŒ
- ğŸŸ¢ Supabase ê³µì‹ ë¬¸ì„œ ê¶Œì¥ íŒ¨í„´ ì‚¬ìš©
- ğŸŸ¢ ë¡¤ë°± ìš©ì´ (ì´ë©”ì¼ í…œí”Œë¦¿ë§Œ ì›ë³µ)
- ğŸŸ¢ ì„¸ì…˜ ì œê±° ë¡œì§ìœ¼ë¡œ ë³´ì•ˆ ê°•í™”

## ğŸš€ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê°œë°œ í™˜ê²½
- [ ] `app/api/auth/verify/route.ts` ìƒì„± (ì„¸ì…˜ ì œê±° ë¡œì§ í¬í•¨)
- [ ] `app/(auth)/login/page.tsx` Toast + ì¬ì „ì†¡ ë²„íŠ¼ ë¡œì§ ì¶”ê°€
- [ ] Supabase Dashboard ì´ë©”ì¼ í…œí”Œë¦¿ ìˆ˜ì •
- [ ] Supabase Dashboard Site URL ì„¤ì • í™•ì¸ (`http://localhost:3000`)
- [ ] ë¡œì»¬ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ (ì„¸ì…˜ ì œê±° í™•ì¸)

### í”„ë¡œë•ì…˜ ë°°í¬
- [ ] í”„ë¡œë•ì…˜ Supabase í”„ë¡œì íŠ¸ ì´ë©”ì¼ í…œí”Œë¦¿ ìˆ˜ì •
- [ ] Supabase Dashboard Site URL ì„¤ì • í™•ì¸ (í”„ë¡œë•ì…˜ ë„ë©”ì¸)
- [ ] ë°°í¬ í›„ ì‹¤ì œ ì´ë©”ì¼ ì¸ì¦ í…ŒìŠ¤íŠ¸
- [ ] ì„¸ì…˜ ì œê±° ë™ì‘ í™•ì¸
- [ ] ê´€ë¦¬ì ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ì •ìƒ ì‘ë™ í™•ì¸

## ğŸ“ ì¶”ê°€ ê°œì„  ì•„ì´ë””ì–´ (í–¥í›„)

1. **ì¬ì „ì†¡ ê¸°ëŠ¥ êµ¬í˜„**
   - ì´ë©”ì¼ ì¸ì¦ ì‹¤íŒ¨ ì‹œ "ì¸ì¦ ë©”ì¼ ì¬ì „ì†¡" ë²„íŠ¼ ê¸°ëŠ¥ êµ¬í˜„
   - Rate limit ê³ ë ¤í•œ ì¬ì „ì†¡ ë¡œì§

2. **ë¶„ì„ ì¶”ì **
   - ì´ë©”ì¼ ì¸ì¦ ì„±ê³µ/ì‹¤íŒ¨ìœ¨ ëª¨ë‹ˆí„°ë§
   - ì‚¬ìš©ìë³„ ì¸ì¦ ì†Œìš” ì‹œê°„ ì¶”ì 
   - AuthError ì½”ë“œë³„ ë°œìƒ ë¹ˆë„ ë¶„ì„

3. **ë‹¤êµ­ì–´ ì§€ì›**
   - ì´ë©”ì¼ í…œí”Œë¦¿ ë‹¤êµ­ì–´ ë²„ì „ ì œê³µ
   - Toast ë©”ì‹œì§€ ë‹¤êµ­ì–´ ì§€ì›

4. **ì•Œë¦¼ í™•ì¥**
   - ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ ì‹œ ê´€ë¦¬ìì—ê²Œ ì•Œë¦¼
   - ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œì— ì¸ì¦ ìƒíƒœ í‘œì‹œ

5. **ì—ëŸ¬ ë³µêµ¬ ìë™í™”**
   - íŠ¹ì • ì—ëŸ¬ ë°œìƒ ì‹œ ìë™ ì¬ì „ì†¡
   - Rate limit ì—ëŸ¬ ì‹œ ëŒ€ê¸° ì‹œê°„ ì•ˆë‚´

## ğŸ”— ì°¸ê³  ìë£Œ

- [Supabase Email Templates ê³µì‹ ë¬¸ì„œ](https://supabase.com/docs/guides/auth/auth-email-templates)
- [Supabase verifyOtp API Reference](https://supabase.com/docs/reference/javascript/auth-verifyotp)
- [Supabase Auth Error Codes](https://supabase.com/docs/guides/auth/debugging/error-codes)
- [Passwordless Email Logins ê°€ì´ë“œ](https://supabase.com/docs/guides/auth/auth-email-passwordless)
- [Server-Side Auth for Next.js](https://supabase.com/docs/guides/auth/server-side/nextjs)

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2025-01-05
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-01-05 (AuthError ì½”ë“œ ì¶”ê°€, ì„¸ì…˜ ì œê±° ë¡œì§ ì¶”ê°€, createServerSupabase() ì‚¬ìš©, redirect_to ì œê±°)
**ì‘ì„±ì**: Claude Code
**ìƒíƒœ**: âœ… ê³„íš ì™„ë£Œ (êµ¬í˜„ ëŒ€ê¸°)
