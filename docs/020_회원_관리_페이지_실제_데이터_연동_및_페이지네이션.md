# 020. íšŒì› ê´€ë¦¬ í˜ì´ì§€ ì‹¤ì œ ë°ì´í„° ì—°ë™ ë° í˜ì´ì§€ë„¤ì´ì…˜

## ğŸ“‹ ê°œìš”

Admin ë„ë©”ì¸ì˜ Users í˜ì´ì§€ì— ì‹¤ì œ Supabase ë°ì´í„°ë¥¼ ì—°ë™í•˜ê³ , ì„œë²„ ì‚¬ì´ë“œ í˜ì´ì§€ë„¤ì´ì…˜ ë° í•„í„°ë§ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

### ì‘ì—… ëª©í‘œ
- âœ… ì‹¤ì œ Supabase ë°ì´í„° ì—°ë™
- âœ… í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ í˜¸ì¶œí•˜ëŠ” í•„í„°ë§/ê²€ìƒ‰/í˜ì´ì§€ë„¤ì´ì…˜ êµ¬í˜„ (BrowserClient ì‚¬ìš©)
- âœ… TanStack Tableì„ ì‚¬ìš©í•œ ê³ ê¸‰ í…Œì´ë¸” UI
- âœ… ëŒ€ì‹œë³´ë“œ â†’ Users í˜ì´ì§€ í•„í„° ìƒíƒœ ì „ë‹¬ (searchParams ì œì™¸)
- âœ… ì—­í•  í•„í„° ê¸°ë³¸ê°’ì„ 'member'ë¡œ ì„¤ì •, 'ì „ì²´ ì—­í• ' ì˜µì…˜ ì œê±°
- âœ… 10ëª… ë‹¨ìœ„ í˜ì´ì§€ë„¤ì´ì…˜
- âœ… is_approved í•„ë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì—¬ ìƒíƒœ êµ¬ë¶„ (null/true/false)

## ğŸ“ ì˜í–¥ë°›ëŠ” íŒŒì¼

### ì‹ ê·œ íŒŒì¼
```
lib/api/
  â””â”€â”€ users.ts                # Supabase users ì¿¼ë¦¬ í•¨ìˆ˜ (BrowserClient ì‚¬ìš©)

components/admin/users/
  â”œâ”€â”€ UserTableClient.tsx     # TanStack Table ê¸°ë°˜ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
  â””â”€â”€ Pagination.tsx          # í˜ì´ì§€ë„¤ì´ì…˜ ì»´í¬ë„ŒíŠ¸ (ì˜µì…˜)
```

### ìˆ˜ì • íŒŒì¼
```
lib/admin/
  â”œâ”€â”€ types.ts                # í˜ì´ì§€ë„¤ì´ì…˜ íƒ€ì… ì¶”ê°€
  â””â”€â”€ store.ts                # Zustand ìŠ¤í† ì–´ ê°œì„ 

components/admin/users/
  â”œâ”€â”€ UserFilters.tsx         # ì—­í•  í•„í„° ê¸°ë³¸ê°’ ìˆ˜ì •, is_approved ì‚¬ìš©
  â””â”€â”€ UserTable.tsx           # ì œê±° ë˜ëŠ” ë ˆê±°ì‹œë¡œ ì´ë™

components/admin/dashboard/
  â””â”€â”€ ActivityFeed.tsx        # ì „ì²´ë³´ê¸° ë²„íŠ¼ ì¶”ê°€

app/admin/users/
  â””â”€â”€ page.tsx                # Client Componentë¡œ ìœ ì§€, useEffectë¡œ ë°ì´í„° fetch
```

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì„¤ê³„

### 1. ë°ì´í„° íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Client Component (page.tsx)                â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Zustand Store (userFilters)              â”‚    â”‚
â”‚  â”‚   - search?: string                         â”‚    â”‚
â”‚  â”‚   - is_approved?: boolean | null           â”‚    â”‚
â”‚  â”‚   - role: 'member' | 'admin' (ê¸°ë³¸: member)â”‚    â”‚
â”‚  â”‚   - page: number                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                     â†“                                â”‚
â”‚  useEffect(() => {                                  â”‚
â”‚    fetchData(filters) // lib/api/users.ts í˜¸ì¶œ      â”‚
â”‚  }, [filters])                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      lib/api/users.ts (getUsersWithPagination)      â”‚
â”‚                                                      â”‚
â”‚  1. BrowserClient ìƒì„± (lib/supabase/client.ts)    â”‚
â”‚  2. í•„í„°ë§ ì¿¼ë¦¬ ì ìš©                                  â”‚
â”‚     - role í•„í„° (í•„ìˆ˜)                               â”‚
â”‚     - is_approved í•„í„° (ì˜µì…˜)                        â”‚
â”‚       * undefined: ì „ì²´ ì¡°íšŒ                         â”‚
â”‚       * null: ìŠ¹ì¸ ëŒ€ê¸° (is_approved IS NULL)       â”‚
â”‚       * true: ìŠ¹ì¸ë¨ (is_approved = true)           â”‚
â”‚       * false: ê±°ë¶€ë¨ (is_approved = false)         â”‚
â”‚     - search í•„í„° (ì˜µì…˜)                             â”‚
â”‚  3. í˜ì´ì§€ë„¤ì´ì…˜ ì ìš© (.range())                      â”‚
â”‚  4. ì •ë ¬ (created_at DESC)                          â”‚
â”‚  5. ì´ ê°œìˆ˜ ì¡°íšŒ (count: 'exact')                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Supabase DB                        â”‚
â”‚                                                      â”‚
â”‚  SELECT * FROM users                                 â”‚
â”‚  WHERE role = $role                                  â”‚
â”‚    AND is_approved = $is_approved (or IS NULL)      â”‚
â”‚    AND (search filters)                              â”‚
â”‚  ORDER BY created_at DESC                            â”‚
â”‚  LIMIT $limit OFFSET $offset                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           TanStack Table (UserTableClient)           â”‚
â”‚                                                      â”‚
â”‚  - ì„œë²„ í˜ì´ì§€ë„¤ì´ì…˜ (manualPagination: true)         â”‚
â”‚  - Row Selection (ì²´í¬ë°•ìŠ¤)                          â”‚
â”‚  - ë°˜ì‘í˜• í…Œì´ë¸” UI                                   â”‚
â”‚  - ì¼ê´„ ì‘ì—… ë²„íŠ¼                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ëŒ€ì‹œë³´ë“œ â†’ Users í˜ì´ì§€ ì—°ë™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Dashboard (ìµœê·¼ ê°€ì… ìš”ì²­ ì¹´ë“œ)                     â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ìµœê·¼ ê°€ì… ìš”ì²­                             â”‚    â”‚
â”‚  â”‚                                             â”‚    â”‚
â”‚  â”‚  [ì‚¬ìš©ì ëª©ë¡...]                           â”‚    â”‚
â”‚  â”‚                                             â”‚    â”‚
â”‚  â”‚  [ì „ì²´ë³´ê¸° ë²„íŠ¼] â† í´ë¦­                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
         setUserFilters({
           is_approved: null,  // ìŠ¹ì¸ ëŒ€ê¸°
           role: 'member',
           page: 1
         })
                     â†“
         router.push('/admin/users')
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Users Page                              â”‚
â”‚                                                      â”‚
â”‚  useEffect(() => {                                  â”‚
â”‚    const filters = useAdminStore(                   â”‚
â”‚      state => state.userFilters                     â”‚
â”‚    )                                                 â”‚
â”‚    fetchData(filters) // is_approved: null          â”‚
â”‚  }, [])                                             â”‚
â”‚                                                      â”‚
â”‚  â†’ ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ íšŒì›ë§Œ í•„í„°ë§ë˜ì–´ í‘œì‹œ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì£¼ìš” íŠ¹ì§•**:
- âŒ searchParams ì‚¬ìš© ì•ˆ í•¨ (URLì— í•„í„° ì •ë³´ ë…¸ì¶œ ì•ˆ í•¨)
- âœ… Zustand ì „ì—­ ìƒíƒœë¡œ í•„í„° ê³µìœ 
- âœ… í˜ì´ì§€ ì´ë™ í›„ì—ë„ í•„í„° ìœ ì§€
- âœ… ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ í•„í„° ë³€ê²½ ê°€ëŠ¥
- âœ… is_approvedë¥¼ ì§ì ‘ ì‚¬ìš© (ë³„ë„ status í•„ë“œ ì—†ìŒ)

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### users í…Œì´ë¸” (ê¸°ì¡´)
```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  email VARCHAR(255) UNIQUE NOT NULL,
  name VARCHAR(100) NOT NULL,
  organization VARCHAR(200),
  role VARCHAR(20) NOT NULL DEFAULT 'member', -- 'member' | 'admin'
  is_approved BOOLEAN,                         -- null(ëŒ€ê¸°), true(ìŠ¹ì¸), false(ê±°ë¶€)
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_users_role ON users(role);
CREATE INDEX idx_users_is_approved ON users(is_approved);
CREATE INDEX idx_users_created_at ON users(created_at DESC);
```

### í•„í„°ë§ ì¿¼ë¦¬ ì˜ˆì‹œ
```sql
-- ì¼ë°˜ íšŒì› ì¤‘ ìŠ¹ì¸ ëŒ€ê¸°ì ê²€ìƒ‰
SELECT * FROM users
WHERE role = 'member'
  AND is_approved IS NULL
  AND (
    name ILIKE '%ê²€ìƒ‰ì–´%' OR
    email ILIKE '%ê²€ìƒ‰ì–´%' OR
    organization ILIKE '%ê²€ìƒ‰ì–´%'
  )
ORDER BY created_at DESC
LIMIT 10 OFFSET 0;

-- ê´€ë¦¬ì ì¤‘ ìŠ¹ì¸ëœ íšŒì› ê²€ìƒ‰
SELECT * FROM users
WHERE role = 'admin'
  AND is_approved = true
ORDER BY created_at DESC
LIMIT 10 OFFSET 0;

-- ì „ì²´ ìƒíƒœì˜ ì¼ë°˜ íšŒì› ì¡°íšŒ
SELECT * FROM users
WHERE role = 'member'
  -- is_approved ì¡°ê±´ ì—†ìŒ (ì „ì²´)
ORDER BY created_at DESC
LIMIT 10 OFFSET 0;
```

## ğŸ”§ êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

### 1. íƒ€ì… ì •ì˜ (lib/admin/types.ts)

```typescript
// ê¸°ì¡´ UserFilters ìˆ˜ì • - is_approved ì‚¬ìš©
export interface UserFilters {
  search?: string
  is_approved?: boolean | null // undefined: ì „ì²´, null: ëŒ€ê¸°, true: ìŠ¹ì¸, false: ê±°ë¶€
  role: 'member' | 'admin'      // í•„ìˆ˜ë¡œ ë³€ê²½, ê¸°ë³¸ê°’ì€ ìŠ¤í† ì–´ì—ì„œ ì„¤ì •
  page: number                  // ì¶”ê°€
}

// í˜ì´ì§€ë„¤ì´ì…˜ ê²°ê³¼ íƒ€ì…
export interface PaginatedUsers {
  users: User[]
  totalCount: number
  pageCount: number
  currentPage: number
}

// Server Action íŒŒë¼ë¯¸í„° íƒ€ì…
export interface GetUsersParams {
  page: number
  limit: number
  search?: string
  is_approved?: boolean | null
  role: 'member' | 'admin'
}
```

### 2. Zustand ìŠ¤í† ì–´ ìˆ˜ì • (lib/admin/store.ts)

```typescript
interface AdminState {
  // ê¸°ì¡´ í•„ë“œë“¤...

  userFilters: UserFilters
  setUserFilters: (filters: Partial<UserFilters>) => void
  resetUserFilters: () => void
}

const initialUserFilters: UserFilters = {
  search: undefined,
  is_approved: undefined, // ì „ì²´ ìƒíƒœ
  role: 'member',         // ê¸°ë³¸ê°’: ì¼ë°˜ íšŒì›
  page: 1,
}

export const useAdminStore = create<AdminState>((set) => ({
  // ê¸°ì¡´ ìƒíƒœë“¤...

  userFilters: initialUserFilters,

  setUserFilters: (filters) =>
    set((state) => ({
      userFilters: { ...state.userFilters, ...filters },
    })),

  resetUserFilters: () =>
    set({ userFilters: initialUserFilters }),
}))
```

### 3. lib/api/users.ts (BrowserClient íŒ¨í„´)

```typescript
import { supabase } from '@/lib/supabase/client'
import { GetUsersParams, PaginatedUsers } from '@/lib/admin/types'

interface PaginatedApiResponse<T> {
  data: T | null
  totalCount: number
  error: string | null
  success: boolean
}

export async function getUsersWithPagination(
  params: GetUsersParams
): Promise<PaginatedApiResponse<PaginatedUsers>> {
  const { page, limit, search, is_approved, role } = params

  try {
    // í˜ì´ì§€ë„¤ì´ì…˜ ê³„ì‚°
  const start = (page - 1) * limit
  const end = start + limit - 1

  // ì¿¼ë¦¬ ì‹œì‘
  let query = supabase
    .from('users')
    .select('*', { count: 'exact' })

  // ì—­í•  í•„í„° (í•„ìˆ˜)
  query = query.eq('role', role)

  // is_approved í•„í„° (ì˜µì…˜)
  if (is_approved === null) {
    // ìŠ¹ì¸ ëŒ€ê¸°: is_approved IS NULL
    query = query.is('is_approved', null)
  } else if (is_approved === true) {
    // ìŠ¹ì¸ë¨: is_approved = true
    query = query.eq('is_approved', true)
  } else if (is_approved === false) {
    // ê±°ë¶€ë¨: is_approved = false
    query = query.eq('is_approved', false)
  }
  // is_approvedê°€ undefinedì´ë©´ ì¡°ê±´ ì¶”ê°€ ì•ˆ í•¨ (ì „ì²´)

  // ê²€ìƒ‰ í•„í„° (ì˜µì…˜)
  if (search && search.trim()) {
    const searchPattern = `%${search.trim()}%`
    query = query.or(
      `name.ilike.${searchPattern},email.ilike.${searchPattern},organization.ilike.${searchPattern}`
    )
  }

  // ì •ë ¬ ë° í˜ì´ì§€ë„¤ì´ì…˜
  query = query
    .order('created_at', { ascending: false })
    .range(start, end)

  const { data, error, count } = await query

  if (error) {
    console.error('Error fetching users:', error)
    throw new Error('ì‚¬ìš©ì ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')
  }

  return {
    users: data ?? [],
    totalCount: count ?? 0,
    pageCount: Math.ceil((count ?? 0) / limit),
    currentPage: page,
  }
}

// ì¼ê´„ ìŠ¹ì¸ Server Action
export async function bulkApproveUsers(userIds: string[]) {
  const supabase = createClient()

  const { error } = await supabase
    .from('users')
    .update({ is_approved: true })
    .in('id', userIds)

  if (error) {
    throw new Error('ì¼ê´„ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')
  }

  return { success: true }
}

// ì¼ê´„ ì°¨ë‹¨ Server Action
export async function bulkBlockUsers(userIds: string[]) {
  const supabase = createClient()

  const { error } = await supabase
    .from('users')
    .update({ is_approved: false })
    .in('id', userIds)

  if (error) {
    throw new Error('ì¼ê´„ ì°¨ë‹¨ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')
  }

  return { success: true }
}
```

### 4. UserFilters ìˆ˜ì • (components/admin/users/UserFilters.tsx)

```typescript
'use client'

import { Search } from 'lucide-react'
import { Input } from '@/components/ui/input'
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select'
import { UserFilters as UserFiltersType } from '@/lib/admin/types'

interface UserFiltersProps {
  filters: UserFiltersType
  onFilterChange: (filters: UserFiltersType) => void
}

export function UserFilters({ filters, onFilterChange }: UserFiltersProps) {
  const handleSearchChange = (value: string) => {
    onFilterChange({ ...filters, search: value || undefined, page: 1 })
  }

  const handleApprovalStatusChange = (value: string) => {
    let isApproved: boolean | null | undefined

    if (value === 'all') {
      isApproved = undefined // ì „ì²´
    } else if (value === 'pending') {
      isApproved = null // ìŠ¹ì¸ ëŒ€ê¸°
    } else if (value === 'approved') {
      isApproved = true // ìŠ¹ì¸ë¨
    } else if (value === 'blocked') {
      isApproved = false // ê±°ë¶€ë¨
    }

    onFilterChange({
      ...filters,
      is_approved: isApproved,
      page: 1, // í•„í„° ë³€ê²½ ì‹œ ì²« í˜ì´ì§€ë¡œ
    })
  }

  const handleRoleChange = (value: string) => {
    onFilterChange({
      ...filters,
      role: value as 'member' | 'admin',
      page: 1,
    })
  }

  // is_approved ê°’ì„ Select valueë¡œ ë³€í™˜
  const getApprovalStatusValue = () => {
    if (filters.is_approved === undefined) return 'all'
    if (filters.is_approved === null) return 'pending'
    if (filters.is_approved === true) return 'approved'
    if (filters.is_approved === false) return 'blocked'
    return 'all'
  }

  return (
    <div className="flex flex-wrap gap-4">
      {/* ê²€ìƒ‰ */}
      <div className="relative min-w-[200px] flex-1">
        <Search className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400" />
        <Input
          placeholder="ì´ë¦„, ì´ë©”ì¼, ì†Œì† ê²€ìƒ‰..."
          value={filters.search || ''}
          onChange={(e) => handleSearchChange(e.target.value)}
          className="pl-10"
        />
      </div>

      {/* ìŠ¹ì¸ ìƒíƒœ í•„í„° */}
      <Select
        value={getApprovalStatusValue()}
        onValueChange={handleApprovalStatusChange}
      >
        <SelectTrigger className="w-[150px]">
          <SelectValue placeholder="ìŠ¹ì¸ ìƒíƒœ" />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="all">ì „ì²´ ìƒíƒœ</SelectItem>
          <SelectItem value="approved">ìŠ¹ì¸ë¨</SelectItem>
          <SelectItem value="pending">ìŠ¹ì¸ ëŒ€ê¸°</SelectItem>
          <SelectItem value="blocked">ê±°ë¶€ë¨</SelectItem>
        </SelectContent>
      </Select>

      {/* ì—­í•  í•„í„° - 'ì „ì²´ ì—­í• ' ì˜µì…˜ ì œê±° */}
      <Select value={filters.role} onValueChange={handleRoleChange}>
        <SelectTrigger className="w-[150px]">
          <SelectValue placeholder="ì—­í• " />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="member">ì¼ë°˜ íšŒì›</SelectItem>
          <SelectItem value="admin">ê´€ë¦¬ì</SelectItem>
        </SelectContent>
      </Select>
    </div>
  )
}
```

### 5. UserTableClient ì»´í¬ë„ŒíŠ¸ (components/admin/users/UserTableClient.tsx)

```typescript
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import {
  useReactTable,
  getCoreRowModel,
  ColumnDef,
  flexRender,
} from '@tanstack/react-table'
import { Badge } from '@/components/ui/badge'
import { Button } from '@/components/ui/button'
import { Checkbox } from '@/components/ui/checkbox'
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table'
import { User, PaginatedUsers } from '@/lib/admin/types'
import { format } from 'date-fns'
import { ko } from 'date-fns/locale'
import { Eye, CheckCircle, XCircle, ChevronLeft, ChevronRight } from 'lucide-react'

interface UserTableClientProps {
  data: PaginatedUsers
  onPageChange: (page: number) => void
  onBulkApprove: (userIds: string[]) => void
  onBulkBlock: (userIds: string[]) => void
}

export function UserTableClient({
  data,
  onPageChange,
  onBulkApprove,
  onBulkBlock,
}: UserTableClientProps) {
  const router = useRouter()
  const [rowSelection, setRowSelection] = useState({})

  const getStatusBadge = (isApproved: boolean | null) => {
    if (isApproved === true) {
      return <Badge className="bg-green-100 text-green-700 hover:bg-green-100">ìŠ¹ì¸ë¨</Badge>
    } else if (isApproved === null) {
      return <Badge className="bg-yellow-100 text-yellow-700 hover:bg-yellow-100">ëŒ€ê¸° ì¤‘</Badge>
    } else {
      return <Badge variant="destructive" className="bg-red-100 text-red-700 hover:bg-red-100">ê±°ë¶€ë¨</Badge>
    }
  }

  const getRoleBadge = (role: string) => {
    if (role === 'admin') {
      return <Badge variant="default">ê´€ë¦¬ì</Badge>
    }
    return <Badge variant="outline">ì¼ë°˜ íšŒì›</Badge>
  }

  const columns: ColumnDef<User>[] = [
    {
      id: 'select',
      header: ({ table }) => (
        <Checkbox
          checked={table.getIsAllPageRowsSelected()}
          onCheckedChange={(value) => table.toggleAllPageRowsSelected(!!value)}
          aria-label="Select all"
        />
      ),
      cell: ({ row }) => (
        <Checkbox
          checked={row.getIsSelected()}
          onCheckedChange={(value) => row.toggleSelected(!!value)}
          aria-label="Select row"
        />
      ),
      enableSorting: false,
      enableHiding: false,
    },
    {
      accessorKey: 'name',
      header: 'ì´ë¦„',
      cell: ({ row }) => <div className="font-medium">{row.getValue('name')}</div>,
    },
    {
      accessorKey: 'email',
      header: 'ì´ë©”ì¼',
      cell: ({ row }) => <div className="text-gray-600">{row.getValue('email')}</div>,
    },
    {
      accessorKey: 'organization',
      header: 'ì†Œì†',
      cell: ({ row }) => <div className="text-gray-600">{row.getValue('organization') || '-'}</div>,
    },
    {
      accessorKey: 'is_approved',
      header: 'ìƒíƒœ',
      cell: ({ row }) => getStatusBadge(row.getValue('is_approved')),
    },
    {
      accessorKey: 'role',
      header: 'ì—­í• ',
      cell: ({ row }) => getRoleBadge(row.getValue('role')),
    },
    {
      accessorKey: 'created_at',
      header: 'ê°€ì…ì¼',
      cell: ({ row }) => (
        <div className="text-gray-600">
          {format(new Date(row.getValue('created_at')), 'PPP', { locale: ko })}
        </div>
      ),
    },
    {
      id: 'actions',
      header: () => <div className="text-right">ì‘ì—…</div>,
      cell: ({ row }) => (
        <div className="text-right">
          <Button
            variant="ghost"
            size="sm"
            onClick={() => router.push(`/admin/users/${row.original.id}`)}
            className="gap-1"
          >
            <Eye className="h-4 w-4" />
            ìƒì„¸
          </Button>
        </div>
      ),
    },
  ]

  const table = useReactTable({
    data: data.users,
    columns,
    getCoreRowModel: getCoreRowModel(),
    manualPagination: true,
    pageCount: data.pageCount,
    state: {
      rowSelection,
      pagination: {
        pageIndex: data.currentPage - 1,
        pageSize: 10,
      },
    },
    onRowSelectionChange: setRowSelection,
  })

  const selectedIds = table
    .getFilteredSelectedRowModel()
    .rows.map((row) => row.original.id)

  return (
    <div className="space-y-4">
      {/* ì¼ê´„ ì‘ì—… ë²„íŠ¼ */}
      {selectedIds.length > 0 && (
        <div className="flex items-center gap-2 rounded-lg border bg-blue-50 p-3">
          <span className="text-sm font-medium text-gray-700">{selectedIds.length}ëª… ì„ íƒë¨</span>
          <div className="ml-auto flex gap-2">
            <Button
              size="sm"
              variant="outline"
              onClick={() => {
                onBulkApprove(selectedIds)
                setRowSelection({})
              }}
              className="gap-1"
            >
              <CheckCircle className="h-4 w-4" />
              ì¼ê´„ ìŠ¹ì¸
            </Button>
            <Button
              size="sm"
              variant="outline"
              onClick={() => {
                onBulkBlock(selectedIds)
                setRowSelection({})
              }}
              className="gap-1 text-red-600 hover:text-red-700"
            >
              <XCircle className="h-4 w-4" />
              ì¼ê´„ ì°¨ë‹¨
            </Button>
          </div>
        </div>
      )}

      {/* í…Œì´ë¸” */}
      <div className="rounded-lg border bg-white">
        <Table>
          <TableHeader>
            {table.getHeaderGroups().map((headerGroup) => (
              <TableRow key={headerGroup.id}>
                {headerGroup.headers.map((header) => (
                  <TableHead key={header.id}>
                    {header.isPlaceholder
                      ? null
                      : flexRender(header.column.columnDef.header, header.getContext())}
                  </TableHead>
                ))}
              </TableRow>
            ))}
          </TableHeader>
          <TableBody>
            {table.getRowModel().rows?.length ? (
              table.getRowModel().rows.map((row) => (
                <TableRow
                  key={row.id}
                  data-state={row.getIsSelected() && 'selected'}
                  className="hover:bg-gray-50"
                >
                  {row.getVisibleCells().map((cell) => (
                    <TableCell key={cell.id}>
                      {flexRender(cell.column.columnDef.cell, cell.getContext())}
                    </TableCell>
                  ))}
                </TableRow>
              ))
            ) : (
              <TableRow>
                <TableCell colSpan={columns.length} className="h-24 text-center text-gray-500">
                  ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
                </TableCell>
              </TableRow>
            )}
          </TableBody>
        </Table>
      </div>

      {/* í˜ì´ì§€ë„¤ì´ì…˜ */}
      <div className="flex items-center justify-between">
        <div className="text-sm text-gray-600">
          ì „ì²´ {data.totalCount}ëª… ì¤‘ {data.users.length}ëª… í‘œì‹œ
        </div>
        <div className="flex items-center gap-2">
          <Button
            variant="outline"
            size="sm"
            onClick={() => onPageChange(data.currentPage - 1)}
            disabled={data.currentPage === 1}
          >
            <ChevronLeft className="h-4 w-4" />
            ì´ì „
          </Button>
          <span className="text-sm">
            {data.currentPage} / {data.pageCount || 1}
          </span>
          <Button
            variant="outline"
            size="sm"
            onClick={() => onPageChange(data.currentPage + 1)}
            disabled={data.currentPage >= data.pageCount}
          >
            ë‹¤ìŒ
            <ChevronRight className="h-4 w-4" />
          </Button>
        </div>
      </div>
    </div>
  )
}
```

### 6. page.tsx ë¦¬íŒ©í† ë§ (app/admin/users/page.tsx)

```typescript
'use client'

import { useState, useEffect } from 'react'
import { useAdminTitle } from '@/components/admin/layout/AdminContext'
import { UserFilters } from '@/components/admin/users/UserFilters'
import { UserTableClient } from '@/components/admin/users/UserTableClient'
import { useAdminStore } from '@/lib/admin/store'
import { useToast } from '@/hooks/use-toast'
import { PaginatedUsers } from '@/lib/admin/types'
import { getUsersWithPagination, bulkApproveUsers, bulkBlockUsers } from './actions'
import { LoadingSpinner } from '@/components/common/LoadingSpinner'

export default function AdminUsersPage() {
  useAdminTitle('íšŒì› ê´€ë¦¬')
  const { toast } = useToast()
  const { userFilters, setUserFilters } = useAdminStore()
  const [data, setData] = useState<PaginatedUsers | null>(null)
  const [loading, setLoading] = useState(true)

  // ë°ì´í„° í˜ì¹­
  useEffect(() => {
    async function fetchData() {
      setLoading(true)
      try {
        const result = await getUsersWithPagination({
          page: userFilters.page,
          limit: 10,
          search: userFilters.search,
          is_approved: userFilters.is_approved,
          role: userFilters.role,
        })
        setData(result)
      } catch (error) {
        toast({
          title: 'ì˜¤ë¥˜',
          description: 'ì‚¬ìš©ì ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
          variant: 'destructive',
        })
      } finally {
        setLoading(false)
      }
    }
    fetchData()
  }, [userFilters, toast])

  const handlePageChange = (page: number) => {
    setUserFilters({ page })
  }

  const handleBulkApprove = async (userIds: string[]) => {
    try {
      await bulkApproveUsers(userIds)
      toast({
        title: 'ìŠ¹ì¸ ì™„ë£Œ',
        description: `${userIds.length}ëª…ì˜ íšŒì›ì„ ìŠ¹ì¸í–ˆìŠµë‹ˆë‹¤.`,
      })
      // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
      setUserFilters({ ...userFilters })
    } catch (error) {
      toast({
        title: 'ì˜¤ë¥˜',
        description: 'ì¼ê´„ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
        variant: 'destructive',
      })
    }
  }

  const handleBulkBlock = async (userIds: string[]) => {
    try {
      await bulkBlockUsers(userIds)
      toast({
        title: 'ì°¨ë‹¨ ì™„ë£Œ',
        description: `${userIds.length}ëª…ì˜ íšŒì›ì„ ì°¨ë‹¨í–ˆìŠµë‹ˆë‹¤.`,
        variant: 'destructive',
      })
      // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
      setUserFilters({ ...userFilters })
    } catch (error) {
      toast({
        title: 'ì˜¤ë¥˜',
        description: 'ì¼ê´„ ì°¨ë‹¨ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
        variant: 'destructive',
      })
    }
  }

  if (loading) {
    return (
      <div className="flex h-96 items-center justify-center">
        <LoadingSpinner />
      </div>
    )
  }

  if (!data) {
    return (
      <div className="flex h-96 items-center justify-center text-gray-500">
        ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
      </div>
    )
  }

  return (
    <div className="space-y-6">
      {/* í•„í„° */}
      <UserFilters filters={userFilters} onFilterChange={setUserFilters} />

      {/* íšŒì› í…Œì´ë¸” */}
      <UserTableClient
        data={data}
        onPageChange={handlePageChange}
        onBulkApprove={handleBulkApprove}
        onBulkBlock={handleBulkBlock}
      />
    </div>
  )
}
```

### 7. ActivityFeed ìˆ˜ì • (components/admin/dashboard/ActivityFeed.tsx)

```typescript
'use client'

import { useRouter } from 'next/navigation'
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'
import { Button } from '@/components/ui/button'
import { Badge } from '@/components/ui/badge'
import { formatDistanceToNow } from 'date-fns'
import { ko } from 'date-fns/locale'
import { FileImage, UserPlus, ArrowRight } from 'lucide-react'
import { useAdminStore } from '@/lib/admin/store'

interface PendingContentItem {
  id: string
  file_name: string
  user_name: string
  created_at: string
}

interface PendingUserItem {
  id: string
  name: string
  email: string
  created_at: string
}

interface ActivityFeedProps {
  pendingContents: PendingContentItem[]
  pendingUsers: PendingUserItem[]
  maxItems?: number
}

export function ActivityFeed({ pendingContents, pendingUsers, maxItems = 10 }: ActivityFeedProps) {
  const router = useRouter()
  const { setUserFilters } = useAdminStore()

  const displayedContents = pendingContents.slice(0, maxItems)
  const displayedUsers = pendingUsers.slice(0, maxItems)

  const getTimeAgo = (dateString: string) => {
    try {
      return formatDistanceToNow(new Date(dateString), {
        addSuffix: true,
        locale: ko,
      })
    } catch {
      return 'ì•Œ ìˆ˜ ì—†ìŒ'
    }
  }

  const handleViewAllUsers = () => {
    // Zustand ìŠ¤í† ì–´ì— í•„í„° ì„¤ì • - is_approved: null (ìŠ¹ì¸ ëŒ€ê¸°)
    setUserFilters({
      is_approved: null,
      role: 'member',
      page: 1,
      search: undefined,
    })
    // Users í˜ì´ì§€ë¡œ ì´ë™
    router.push('/admin/users')
  }

  return (
    <div className="grid gap-6 md:grid-cols-2">
      {/* ìµœê·¼ ëŒ€ê¸°ì¤‘ì¸ ì½˜í…ì¸  */}
      <Card>
        <CardHeader>
          <CardTitle className="flex items-center gap-2 text-lg">
            <FileImage className="h-5 w-5 text-blue-600" />
            ìµœê·¼ ëŒ€ê¸°ì¤‘ì¸ ì½˜í…ì¸ 
          </CardTitle>
        </CardHeader>
        <CardContent>
          {displayedContents.length === 0 ? (
            <p className="text-sm text-gray-500">ëŒ€ê¸°ì¤‘ì¸ ì½˜í…ì¸ ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
          ) : (
            <div className="space-y-3">
              {displayedContents.map((content) => (
                <div
                  key={content.id}
                  className="flex items-start justify-between border-b pb-3 last:border-0 last:pb-0"
                >
                  <div className="flex-1">
                    <p className="text-sm font-medium text-gray-900">{content.file_name}</p>
                    <p className="text-xs text-gray-500">ì—…ë¡œë”: {content.user_name}</p>
                  </div>
                  <div className="ml-4 flex flex-col items-end gap-1">
                    <Badge variant="secondary" className="bg-gray-100 text-gray-700">
                      ëŒ€ê¸°ì¤‘
                    </Badge>
                    <span className="text-xs text-gray-400">{getTimeAgo(content.created_at)}</span>
                  </div>
                </div>
              ))}
            </div>
          )}
        </CardContent>
      </Card>

      {/* ìµœê·¼ ê°€ì… ìš”ì²­ */}
      <Card>
        <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-4">
          <CardTitle className="flex items-center gap-2 text-lg">
            <UserPlus className="h-5 w-5 text-green-600" />
            ìµœê·¼ ê°€ì… ìš”ì²­
          </CardTitle>
          {displayedUsers.length > 0 && (
            <Button
              variant="ghost"
              size="sm"
              onClick={handleViewAllUsers}
              className="gap-1 text-blue-600 hover:text-blue-700"
            >
              ì „ì²´ë³´ê¸°
              <ArrowRight className="h-4 w-4" />
            </Button>
          )}
        </CardHeader>
        <CardContent>
          {displayedUsers.length === 0 ? (
            <p className="text-sm text-gray-500">ê°€ì… ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
          ) : (
            <div className="space-y-3">
              {displayedUsers.map((user) => (
                <div
                  key={user.id}
                  className="flex items-start justify-between border-b pb-3 last:border-0 last:pb-0"
                >
                  <div className="flex-1">
                    <p className="text-sm font-medium text-gray-900">{user.name}</p>
                    <p className="text-xs text-gray-500">{user.email}</p>
                  </div>
                  <div className="ml-4 flex flex-col items-end gap-1">
                    <Badge variant="secondary" className="bg-yellow-100 text-yellow-700">
                      ìŠ¹ì¸ ëŒ€ê¸°
                    </Badge>
                    <span className="text-xs text-gray-400">{getTimeAgo(user.created_at)}</span>
                  </div>
                </div>
              ))}
            </div>
          )}
        </CardContent>
      </Card>
    </div>
  )
}
```

## ğŸ“¦ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
npm install @tanstack/react-table
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. í˜ì´ì§€ë„¤ì´ì…˜ í…ŒìŠ¤íŠ¸
- [ ] 10ëª… ë‹¨ìœ„ë¡œ í˜ì´ì§€ë„¤ì´ì…˜ ë™ì‘ í™•ì¸
- [ ] ì´ì „/ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™” í™•ì¸
- [ ] ì´ í˜ì´ì§€ ìˆ˜ ê³„ì‚° ì •í™•ì„± í™•ì¸

### 2. í•„í„°ë§ í…ŒìŠ¤íŠ¸
- [ ] ì—­í•  í•„í„° ê¸°ë³¸ê°’ 'member' í™•ì¸
- [ ] 'ì „ì²´ ì—­í• ' ì˜µì…˜ ì œê±° í™•ì¸
- [ ] is_approved í•„í„° ë™ì‘ í™•ì¸
  - [ ] ì „ì²´: is_approved ì¡°ê±´ ì—†ìŒ
  - [ ] ìŠ¹ì¸ ëŒ€ê¸°: is_approved IS NULL
  - [ ] ìŠ¹ì¸ë¨: is_approved = true
  - [ ] ê±°ë¶€ë¨: is_approved = false
- [ ] ê²€ìƒ‰ ê¸°ëŠ¥ ë™ì‘ í™•ì¸ (ì´ë¦„, ì´ë©”ì¼, ì†Œì†)
- [ ] í•„í„° ë³€ê²½ ì‹œ 1í˜ì´ì§€ë¡œ ì´ë™ í™•ì¸

### 3. ëŒ€ì‹œë³´ë“œ ì—°ë™ í…ŒìŠ¤íŠ¸
- [ ] ëŒ€ì‹œë³´ë“œ "ì „ì²´ë³´ê¸°" ë²„íŠ¼ í‘œì‹œ í™•ì¸
- [ ] ë²„íŠ¼ í´ë¦­ ì‹œ Users í˜ì´ì§€ ì´ë™ í™•ì¸
- [ ] ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ íšŒì›ë§Œ í•„í„°ë§ë˜ì–´ í‘œì‹œ í™•ì¸ (is_approved: null)
- [ ] ì‚¬ìš©ìê°€ í•„í„° ìˆ˜ë™ ë³€ê²½ ê°€ëŠ¥ í™•ì¸

### 4. ì¼ê´„ ì‘ì—… í…ŒìŠ¤íŠ¸
- [ ] ì²´í¬ë°•ìŠ¤ ì„ íƒ ë™ì‘ í™•ì¸
- [ ] ì „ì²´ ì„ íƒ ê¸°ëŠ¥ í™•ì¸
- [ ] ì¼ê´„ ìŠ¹ì¸ ë™ì‘ ë° ë°ì´í„° ì—…ë°ì´íŠ¸ í™•ì¸ (is_approved = true)
- [ ] ì¼ê´„ ì°¨ë‹¨ ë™ì‘ ë° ë°ì´í„° ì—…ë°ì´íŠ¸ í™•ì¸ (is_approved = false)

### 5. ì„œë²„ ì‚¬ì´ë“œ ì²˜ë¦¬ í™•ì¸
- [ ] í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•„í„°ë§ ì•ˆ í•˜ëŠ”ì§€ í™•ì¸
- [ ] Supabase ì¿¼ë¦¬ë¡œë§Œ í•„í„°ë§ í™•ì¸ (ê°œë°œì ë„êµ¬ Network íƒ­)
- [ ] í˜ì´ì§€ë„¤ì´ì…˜ì´ ì„œë²„ì—ì„œ ì²˜ë¦¬ë˜ëŠ”ì§€ í™•ì¸

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. RLS (Row Level Security) ì •ì±…
```sql
-- ê´€ë¦¬ìë§Œ ì „ì²´ ì‚¬ìš©ì ì¡°íšŒ ê°€ëŠ¥
CREATE POLICY "Admins can view all users"
ON users FOR SELECT
USING (
  auth.jwt() ->> 'role' = 'admin'
);

-- ê´€ë¦¬ìë§Œ ì‚¬ìš©ì is_approved ìƒíƒœ ì—…ë°ì´íŠ¸ ê°€ëŠ¥
CREATE POLICY "Admins can update user approval status"
ON users FOR UPDATE
USING (
  auth.jwt() ->> 'role' = 'admin'
)
WITH CHECK (
  auth.jwt() ->> 'role' = 'admin'
);
```

### 2. Server Action ê¶Œí•œ ê²€ì¦
```typescript
export async function getUsersWithPagination(params: GetUsersParams) {
  const supabase = createClient()

  // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ í™•ì¸
  const { data: { user } } = await supabase.auth.getUser()

  if (!user) {
    throw new Error('ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤.')
  }

  // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
  const { data: userData } = await supabase
    .from('users')
    .select('role')
    .eq('id', user.id)
    .single()

  if (userData?.role !== 'admin') {
    throw new Error('ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.')
  }

  // ì´í›„ ì¿¼ë¦¬ ì‹¤í–‰...
}
```

## ğŸ“ ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: íƒ€ì… ë° ìŠ¤í† ì–´ ì„¤ì •
- [ ] lib/admin/types.ts ìˆ˜ì • (UserFiltersì— is_approved ì‚¬ìš©)
- [ ] lib/admin/store.ts ìˆ˜ì • (role ê¸°ë³¸ê°’ 'member', is_approved ê¸°ë³¸ê°’ undefined)

### Phase 2: Server Action êµ¬í˜„
- [ ] app/admin/users/actions.ts ìƒì„±
- [ ] getUsersWithPagination êµ¬í˜„ (is_approved í•„í„°ë§)
- [ ] bulkApproveUsers êµ¬í˜„ (is_approved = true)
- [ ] bulkBlockUsers êµ¬í˜„ (is_approved = false)

### Phase 3: TanStack Table ì„¤ì¹˜ ë° ì»´í¬ë„ŒíŠ¸ ì‘ì„±
- [ ] @tanstack/react-table ì„¤ì¹˜
- [ ] components/admin/users/UserTableClient.tsx ì‘ì„±
- [ ] ì„œë²„ í˜ì´ì§€ë„¤ì´ì…˜ ì„¤ì •
- [ ] Row Selection êµ¬í˜„

### Phase 4: ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •
- [ ] components/admin/users/UserFilters.tsx ìˆ˜ì • (is_approved ì‚¬ìš©)
- [ ] app/admin/users/page.tsx ë¦¬íŒ©í† ë§ (Server Action ì—°ë™)
- [ ] components/admin/dashboard/ActivityFeed.tsx ìˆ˜ì • (ì „ì²´ë³´ê¸° ë²„íŠ¼, is_approved: null)

### Phase 5: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
- [ ] Playwrightë¥¼ ì‚¬ìš©í•œ E2E í…ŒìŠ¤íŠ¸
- [ ] í˜ì´ì§€ë„¤ì´ì…˜ ë™ì‘ í™•ì¸
- [ ] is_approved í•„í„°ë§ ë™ì‘ í™•ì¸
- [ ] ëŒ€ì‹œë³´ë“œ â†’ Users í˜ì´ì§€ ì—°ë™ í™•ì¸

### Phase 6: ìµœì í™” ë° ë§ˆë¬´ë¦¬
- [ ] ë¡œë”© ìƒíƒœ UI ê°œì„ 
- [ ] ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”
- [ ] ì ‘ê·¼ì„± ê°œì„ 
- [ ] ì½”ë“œ ì •ë¦¬ ë° ë¬¸ì„œí™”

## ğŸ’¡ í•µì‹¬ ë³€ê²½ì‚¬í•­ ìš”ì•½

### is_approved ì§ì ‘ ì‚¬ìš©
- âŒ ë³„ë„ `status` í•„ë“œ ì‚¬ìš© ì•ˆ í•¨
- âœ… `is_approved: boolean | null` ì§ì ‘ ì‚¬ìš©
  - `undefined`: ì „ì²´ (í•„í„° ì—†ìŒ)
  - `null`: ìŠ¹ì¸ ëŒ€ê¸°
  - `true`: ìŠ¹ì¸ë¨
  - `false`: ê±°ë¶€ë¨

### Supabase ì¿¼ë¦¬ ì˜ˆì‹œ
```typescript
// ì „ì²´ ìƒíƒœ
if (is_approved === undefined) {
  // ì¡°ê±´ ì¶”ê°€ ì•ˆ í•¨
}

// ìŠ¹ì¸ ëŒ€ê¸°
if (is_approved === null) {
  query = query.is('is_approved', null)
}

// ìŠ¹ì¸ë¨
if (is_approved === true) {
  query = query.eq('is_approved', true)
}

// ê±°ë¶€ë¨
if (is_approved === false) {
  query = query.eq('is_approved', false)
}
```

## ğŸ“š ì°¸ê³  ìë£Œ

- [TanStack Table v8 Documentation](https://tanstack.com/table/v8)
- [Supabase Server-side Pagination](https://supabase.com/docs/guides/api/pagination)
- [Supabase NULL Filtering](https://supabase.com/docs/reference/javascript/is)
- [Next.js 14 Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations)
- [Zustand Documentation](https://docs.pmnd.rs/zustand)

---

**ì‘ì„±ì¼**: 2025-10-30
**ë‹´ë‹¹**: Claude Code + Developer
**ìš°ì„ ìˆœìœ„**: High
**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 4-6ì‹œê°„
